<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Indovina la Canzone</title>
<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f2f2f2;
    padding: 20px;
}
input, button {
    padding: 10px;
    margin: 5px;
}
button {
    cursor: pointer;
}
ul {
    list-style: none;
    padding: 0;
}
#admin {
    display: none;
    margin-top: 20px;
    padding: 15px;
    background: #fff;
    border-radius: 8px;
}
.score {
    font-weight: bold;
}
</style>
</head>
<body>

<h1>ğŸµ Indovina la Canzone</h1>

<input id="nome" placeholder="Il tuo nome">
<button id="prenotaBtn" onclick="prenota()">Prenotati</button>

<h2>Giocatori</h2>
<ul id="lista"></ul>

<h3 id="risponde"></h3>

<hr>

<h2>ğŸ”’ Admin</h2>
<input type="password" id="password" placeholder="Password admin">
<button onclick="loginAdmin()">Accedi</button>

<div id="admin">
    <button onclick="giusta()">âœ” Risposta Giusta</button>
    <button onclick="sbagliata()">âŒ Risposta Sbagliata</button>
    <button onclick="nuovoRound()">ğŸ”„ Nuova Canzone</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ğŸ” Password admin
const ADMIN_PASSWORD = "admin123";

// Config Firebase (da completare con il tuo progetto)
const firebaseConfig = {
  apiKey: "INSERISCI_API_KEY",
  authDomain: "TUO_PROGETTO.firebaseapp.com",
  databaseURL: "https://TUO_PROGETTO.firebaseio.com",
  projectId: "TUO_PROGETTO",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let prenotato = null;

// ğŸ“Œ Prenotazione giocatore
function prenota() {
    if (prenotato) return alert("Prenotazione chiusa per questo round!");
    const nome = document.getElementById("nome").value.trim();
    if (!nome) return alert("Inserisci il tuo nome!");
    prenotato = nome;
    document.getElementById("prenotaBtn").disabled = true;
    document.getElementById("risponde").textContent = "ğŸ¤ Risponde: " + nome;
    // assicura che il giocatore esista in DB con punteggio iniziale 0
    db.ref("giocatori/" + nome).set({punti: 0});
}

// ğŸ“‹ Lista giocatori live
db.ref("giocatori").on("value", snap => {
    const lista = document.getElementById("lista");
    lista.innerHTML = "";
    snap.forEach(el => {
        const li = document.createElement("li");
        li.innerHTML = el.key + ": <span class='score'>" + el.val().punti + "</span>";
        lista.appendChild(li);
    });
});

// ğŸ”’ Login Admin
function loginAdmin() {
    const pass = document.getElementById("password").value;
    if (pass === ADMIN_PASSWORD) {
        document.getElementById("admin").style.display = "block";
        alert("Accesso admin consentito");
    } else {
        alert("Password sbagliata!");
    }
}

// ğŸ‘‘ Admin: Risposta Giusta
function giusta() {
    if (!prenotato) return alert("Nessun giocatore prenotato!");
    const ref = db.ref("giocatori/" + prenotato + "/punti");
    ref.transaction(p => (p || 0) + 1);
}

// ğŸ‘‘ Admin: Risposta Sbagliata
function sbagliata() {
    if (!prenotato) return alert("Nessun giocatore prenotato!");
    alert(prenotato + " ha sbagliato!");
}

// ğŸ”„ Nuovo round
function nuovoRound() {
    prenotato = null;
    document.getElementById("prenotaBtn").disabled = false;
    document.getElementById("risponde").textContent = "";
}
</script>
</body>
</html>
